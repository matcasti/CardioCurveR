<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Nonlinear Modeling of R-R Interval Dynamics • CardioCurveR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Nonlinear Modeling of R-R Interval Dynamics">
<meta name="description" content="CardioCurveR provides an automated and robust framework for analyzing R-R interval (RRi) signals using advanced nonlinear modeling and preprocessing techniques. The package implements a dual-logistic model to capture the rapid drop and subsequent recovery of RRi during exercise, as described by Castillo-Aguilar et al. (2025). In addition, CardioCurveR includes tools for filtering RRi signals using zero-phase Butterworth low-pass filtering and for cleaning ectopic beats via adaptive outlier replacement using local regression and robust statistics. These integrated methods preserve the dynamic features of RRi signals and facilitate accurate cardiovascular monitoring and clinical research.">
<meta property="og:description" content="CardioCurveR provides an automated and robust framework for analyzing R-R interval (RRi) signals using advanced nonlinear modeling and preprocessing techniques. The package implements a dual-logistic model to capture the rapid drop and subsequent recovery of RRi during exercise, as described by Castillo-Aguilar et al. (2025). In addition, CardioCurveR includes tools for filtering RRi signals using zero-phase Butterworth low-pass filtering and for cleaning ectopic beats via adaptive outlier replacement using local regression and robust statistics. These integrated methods preserve the dynamic features of RRi signals and facilitate accurate cardiovascular monitoring and clinical research.">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">CardioCurveR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matcasti/CardioCurveR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="cardiocurver-nonlinear-modeling-of-r-r-interval-dynamics">CardioCurveR: Nonlinear Modeling of R-R Interval Dynamics<a class="anchor" aria-label="anchor" href="#cardiocurver-nonlinear-modeling-of-r-r-interval-dynamics"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a> <a href="https://CRAN.R-project.org/package=CardioCurveR" class="external-link"><img src="https://www.r-pkg.org/badges/version/CardioCurveR" alt="CRAN status"></a> <a href="https://github.com/matcasti/CardioCurveR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/matcasti/CardioCurveR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/gh/matcasti/CardioCurveR" class="external-link"><img src="https://codecov.io/gh/matcasti/CardioCurveR/graph/badge.svg" alt="Codecov test coverage"></a></p>
<p>CardioCurveR provides an automated and robust framework for modeling RR interval (RRi) signals. The package is built around a dual-logistic model, as described by Castillo-Aguilar et al. (2025), which captures both the rapid drop in RRi during exercise and the subsequent recovery phase. In our formulation, the model is defined by the following equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>R</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>+</mo><mfrac><mi>β</mi><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>λ</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac><mo>−</mo><mfrac><mrow><mi>c</mi><mspace width="0.167em"></mspace><mi>β</mi></mrow><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>ϕ</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mi>τ</mi><mo>−</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
RRi(t) = \alpha + \frac{\beta}{1 + e^{\lambda\ (t-\tau)}} -
         \frac{c\,\beta}{1 + e^{\phi\ (t-\tau-\delta)}},
</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> represents the baseline RRi level, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> controls the amplitude of the drop, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> modulates the steepness of the drop phase, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math> is the time center of the drop, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math> scales the recovery amplitude relative to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math> controls the steepness of the recovery phase, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math> shifts the recovery phase in time relative to the drop.</p>
<p>CardioCurveR also incorporates advanced signal filtering techniques using a zero-phase Butterworth filter to preprocess the RRi data and remove edge artifacts. This ensures that the dynamic fluctuations are preserved for subsequent non-linear modeling.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the development version of CardioCurveR, run the following commands in R. Make sure that you have the <strong>devtools</strong> package installed:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"matcasti/CardioCurveR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="core-functions">Core Functions<a class="anchor" aria-label="anchor" href="#core-functions"></a>
</h2>
<p>The package provides several key functions:</p>
<div class="section level3">
<h3 id="dual-logistic-model-dual_logistic">Dual-Logistic Model: <code>dual_logistic()</code>
<a class="anchor" aria-label="anchor" href="#dual-logistic-model-dual_logistic"></a>
</h3>
<p>This function implements the dual-logistic model from Castillo-Aguilar et al. (2025):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>R</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>+</mo><mfrac><mi>β</mi><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac><mo>−</mo><mfrac><mrow><mi>c</mi><mspace width="0.167em"></mspace><mi>β</mi></mrow><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mi>τ</mi><mo>−</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
RRi(t) = \alpha + \frac{\beta}{1 + e^{\lambda (t-\tau)}} - \frac{c\,\beta}{1 + e^{\phi (t-\tau-\delta)}}
</annotation></semantics></math></p>
<p>It takes a vector of time points and a named vector (or list) of parameters, returning the modeled RRi values.</p>
</div>
<div class="section level3">
<h3 id="parameter-estimation-estimate_rri_curve">Parameter Estimation: <code>estimate_RRi_curve()</code>
<a class="anchor" aria-label="anchor" href="#parameter-estimation-estimate_rri_curve"></a>
</h3>
<p>This function optimizes the dual-logistic model parameters using a robust Huber loss function. The optimization is performed via the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> function with box constraints (default method <code>"L-BFGS-B"</code>). It is designed to yield reliable parameter estimates even in the presence of noisy data.</p>
</div>
<div class="section level3">
<h3 id="signal-filtering-filter_signal">Signal Filtering: <code>filter_signal()</code>
<a class="anchor" aria-label="anchor" href="#signal-filtering-filter_signal"></a>
</h3>
<p>This function applies a Butterworth low-pass filter using zero-phase filtering (with <code>filtfilt()</code>) to clean the RRi signal. To mitigate edge effects from filtering, it trims a specified number of samples from the beginning and end of the filtered signal.</p>
</div>
<div class="section level3">
<h3 id="adaptive-outlier-cleaning-clean_outlier">Adaptive Outlier Cleaning: <code>clean_outlier()</code>
<a class="anchor" aria-label="anchor" href="#adaptive-outlier-cleaning-clean_outlier"></a>
</h3>
<p>The <code><a href="reference/clean_outlier.html">clean_outlier()</a></code> function removes ectopic or noisy beats from an RRi signal. It fits a LOESS model to capture local trends, calculates residuals, and flags outliers based on a robust threshold (multiples of the median absolute deviation). Outliers are then replaced by one of three methods: drawing from a Gaussian or uniform distribution, or simply replacing with the LOESS-predicted values.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-workflow">Example Workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h2>
<div class="section level3">
<h3 id="generating-real-life-data">Generating real-life data<a class="anchor" aria-label="anchor" href="#generating-real-life-data"></a>
</h3>
<p>Below is an extended example that demonstrates the full workflow of simulating, filtering, visualizing, and fitting an RRi signal model.</p>
<p>First we load the package <code>CardioCurveR</code>, assuming that you first installed it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/matcasti/CardioCurveR" class="external-link">CardioCurveR</a></span><span class="op">)</span></span></code></pre></div>
<p>Then, we simulate data with specific parameters from the dual-logistic model described in Castillo-Aguilar et al. (2025).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a time vector and a theoretical RRi signal using the dual-logistic model.</span></span>
<span><span class="va">time_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the true model parameters from Castillo-Aguilar et al. (2025)</span></span>
<span><span class="va">true_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">800</span>, beta <span class="op">=</span> <span class="op">-</span><span class="fl">375</span>, c <span class="op">=</span> <span class="fl">0.85</span>, </span>
<span>                    lambda <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, phi <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, </span>
<span>                    tau <span class="op">=</span> <span class="fl">6</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the theoretical RRi curve using dual_logistic()</span></span>
<span><span class="va">RRi_theoretical</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dual_logistic.html">dual_logistic</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="va">true_params</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arrange the generated data and time vector in a single table</span></span>
<span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">time_vec</span>, </span>
<span>                             RRi_theoretical <span class="op">=</span> <span class="va">RRi_theoretical</span><span class="op">)</span></span></code></pre></div>
<p>And our simulated data will look something like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#&gt;       time  RRi_theoretical</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; 1        0 799.999999143314</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 2     0.01 799.999999067449</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 3     0.02 799.999998988268</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; ...    ...              ...</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 1999 19.98 743.749999907457</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 2000 19.99  743.74999990929</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 2001    20 743.749999911086</span></span></code></pre></div>
<p>We can visualize the generated theoretical curve generated with the <code><a href="reference/dual_logistic.html">dual_logistic()</a></code> function by leveraging <code>ggplot2</code> grammar of graphics like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">## Load ggplot2 package</span></span>
<span></span>
<span><span class="co"># Visualize the theoretical model</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi_theoretical</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Theoretical Dual-Logistic RRi Model"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Generated with the `dual_logistic()` function"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (min)"</span>, y <span class="op">=</span> <span class="st">"RRi (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p>We can additionally generate random noise around our theoretical curve to simulate a real R-R interval signal (because life, has randomness in it):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># Seed for reproducibility</span></span>
<span></span>
<span><span class="co"># Simulate a noisy RRi signal by adding Gaussian noise</span></span>
<span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="op">{</span></span>
<span>  <span class="va">RRi_simulated</span> <span class="op">&lt;-</span> <span class="va">RRi_theoretical</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>So now, we added noise to our perfectly smooth signal, let’s see how does it look now:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi_simulated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.0</span><span class="op">-</span><span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">500</span>, label <span class="op">=</span> <span class="st">"Rest"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">7.5</span>, y <span class="op">=</span> <span class="fl">800</span>, label <span class="op">=</span> <span class="st">"Exercise"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">0.5</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">10</span><span class="op">+</span><span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">500</span>, label <span class="op">=</span> <span class="st">"Recovery"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Dual-Logistic RRi Signal"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"With Random Gaussian Noise Added"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (min)"</span>, y <span class="op">=</span> <span class="st">"RRi (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>So as we see, our model also works to generate and simulate data with noise included, which will serve our purpose to illustrate how we can reverse-engineer the noisy RRi signal back to our theoretical curve.</p>
<p>Let’s first add some ectopic signals to make it look even more real:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co">## Seed for reproducibility</span></span>
<span></span>
<span><span class="co">## Total number of RRi records or points</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## We'll select random points (5% of whole signal)</span></span>
<span><span class="va">ectopics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_samples</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## We'll add a doubled or half value to selected ectopic data points</span></span>
<span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="op">{</span></span>
<span>  <span class="va">RRi_simulated</span><span class="op">[</span><span class="va">ectopics</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">RRi_simulated</span><span class="op">[</span><span class="va">ectopics</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1.7</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s look how looks our noisy, unprocessed signal:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi_simulated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.0</span><span class="op">-</span><span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">500</span>, label <span class="op">=</span> <span class="st">"Rest"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">7.5</span>, y <span class="op">=</span> <span class="fl">800</span>, label <span class="op">=</span> <span class="st">"Exercise"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">0.5</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">10</span><span class="op">+</span><span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">500</span>, label <span class="op">=</span> <span class="st">"Recovery"</span>, col <span class="op">=</span> <span class="st">"gray50"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Dual-Logistic RRi Signal"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"With Random Noise and Ectopic Heartbeats Added"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (min)"</span>, y <span class="op">=</span> <span class="st">"RRi (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>Okay so now this look like real-life signal data. Now the question lies: Can we reverse-engineer this curve back to our nice and smooth theoretical curve? That’s exactly the goal to this package. Let’s see what can we do!</p>
</div>
<div class="section level3">
<h3 id="cleaning-the-rri-data">Cleaning the RRi data<a class="anchor" aria-label="anchor" href="#cleaning-the-rri-data"></a>
</h3>
<p>First, we need to remove ectopic signals. We can do this with our <code><a href="reference/clean_outlier.html">clean_outlier()</a></code> function like this:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## First we call our function</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="reference/clean_outlier.html">clean_outlier</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi_simulated</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## And them, add the cleaned signal to our original table as another column</span></span>
<span><span class="va">simulated_data</span><span class="op">$</span><span class="va">RRi_cleaned</span> <span class="op">&lt;-</span> <span class="va">cleaned_data</span><span class="op">$</span><span class="va">signal</span></span></code></pre></div>
<p>So now, let’s check how it looks our cleaned signal (without ectopic hearbeats):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_simulated</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_cleaned</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Dual-Logistic RRi Signal"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Original (Purple) and Cleaned Signal (Blue)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (min)"</span>, y <span class="op">=</span> <span class="st">"RRi (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>Additionally, we can now filter the noise we add initially (the random gaussian noise) to clean even more our RRi signal. Let’s see how it looks our RRi signal after filtering:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply the Butterworth low-pass filter to the noisy RRi signal</span></span>
<span><span class="va">simulated_data</span><span class="op">$</span><span class="va">RRi_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="reference/filter_signal.html">filter_signal</a></span><span class="op">(</span><span class="va">RRi_cleaned</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_cleaned</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_filtered</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, col <span class="op">=</span> <span class="st">"blue"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated Dual-Logistic RRi Signal"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Cleaned signal (Purple) and Cleaned and Filtered Signal (Blue)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (min)"</span>, y <span class="op">=</span> <span class="st">"RRi (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<p>With this filtered signal we can now focus on capturing the true underlying theoretical curve rather than just capturing the noise from the measurements.</p>
</div>
<div class="section level3">
<h3 id="estimating-the-rri-model">Estimating the RRi model<a class="anchor" aria-label="anchor" href="#estimating-the-rri-model"></a>
</h3>
<p>The estimation process of the original curve is rather simple: we call the function <code><a href="reference/estimate_RRi_curve.html">estimate_RRi_curve()</a></code> and plug the time and RRi vectors inside.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the dual-logistic model parameters from the noisy RRi signal</span></span>
<span><span class="va">fit_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="reference/estimate_RRi_curve.html">estimate_RRi_curve</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi_filtered</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Lets print the results of the estimation of our model parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; RRi_fit Object</span></span>
<span><span class="co">#&gt; Optimization Method: L-BFGS-B </span></span>
<span><span class="co">#&gt; Estimated Parameters:</span></span>
<span><span class="co">#&gt;        alpha         beta            c       lambda          phi          tau </span></span>
<span><span class="co">#&gt;  800.3187317 -379.8993874    0.8606058   -2.9594002   -1.8927805    5.9759377 </span></span>
<span><span class="co">#&gt;        delta </span></span>
<span><span class="co">#&gt;    3.0115352 </span></span>
<span><span class="co">#&gt; Objective Value (Huber loss): 921733.7 </span></span>
<span><span class="co">#&gt; Convergence Code: 0</span></span></code></pre></div>
<p>And as simple as that we have fitted the dual logistic model to our processed data. Let’s explore how well our model captured the pattern from the generated data. We can further use other base functions to explore the resulting object.</p>
<p>For instance, let’s call the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function to our object:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Now lets see a summary with model fit statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of RRi_fit Object</span></span>
<span><span class="co">#&gt; Optimization Method: L-BFGS-B </span></span>
<span><span class="co">#&gt; Estimated Parameters:</span></span>
<span><span class="co">#&gt;        alpha         beta            c       lambda          phi          tau </span></span>
<span><span class="co">#&gt;  800.3187317 -379.8993874    0.8606058   -2.9594002   -1.8927805    5.9759377 </span></span>
<span><span class="co">#&gt;        delta </span></span>
<span><span class="co">#&gt;    3.0115352 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Objective Value (Huber loss): 921733.7 </span></span>
<span><span class="co">#&gt; Residual Sum of Squares (RSS): 1902518 </span></span>
<span><span class="co">#&gt; Total Sum of Squares (TSS): 23025287 </span></span>
<span><span class="co">#&gt; R-squared: 0.9174 </span></span>
<span><span class="co">#&gt; Root Mean Squared Error (RMSE): 30.9  ms </span></span>
<span><span class="co">#&gt; Mean Absolute Percentage Error (MAPE): 3.6  % </span></span>
<span><span class="co">#&gt; Number of observations: 1991 </span></span>
<span><span class="co">#&gt; Convergence Code: 0</span></span></code></pre></div>
<p>We can see that the model have an <code>R-squared</code> of 0.917, which means that is explaining about 91.7% of the variance contained in the generated RRi signal (considering that we start with really messy and noisy RRi data). The <code>RMSE</code> indicates that the average error of the model is only about 30 ms, which is equivalent to an error of 3.6 % according to the <code>MAPE</code>.</p>
<p>We can see plot model diagnostics using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function. Let’s see the result:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Finally, lets see a plot with diagnostics statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>The above plot should show the predicted RRi line (blue) closely following the RRi signal. The middle plot should show that the residuals of the model are evenly spread around the zero line. This is further observed by the histogram of residuals which should be normally distribuited around zero.</p>
<p>Let’s see how well our model did compared to the true underlying curve that we used to generate the data!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add the simulated curve from the estimated parameters</span></span>
<span><span class="va">simulated_data</span><span class="op">$</span><span class="va">RRi_estimated</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dual_logistic.html">dual_logistic</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="va">fit_summary</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_theoretical</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"purple"</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">RRi_estimated</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"True (Purple) and Estimated (Blue) RRi Model"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"RRi (ms)"</span>, x <span class="op">=</span> <span class="st">"Time (min)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
<p>We can see that our model did a fairly well job capturing the underlying true curve, which demonstrate our model’s capabilities in capturing the RRi dynamics in response to exercise when this double-logistic behavior is inherently present.</p>
<p>The above example demonstrates multiple steps. First, a theoretical RRi signal is computed from the dual-logistic model. Next, a noisy version of the signal is simulated and then cleaned using a Butterworth low-pass filter. The cleaned signal is used to estimate the dual-logistic model parameters through a robust optimization procedure. Visualizations are provided for the theoretical curve, the noisy versus filtered signals, the fitted model overlay, and the residuals of the fit, offering comprehensive insight into each stage of the process.</p>
<p>Enjoy exploring your RR interval dynamics and modeling them robustly with CardioCurveR!</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/matcasti/CardioCurveR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/matcasti/CardioCurveR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CardioCurveR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matías Castillo-Aguilar <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7291-247X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matías Castillo-Aguilar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
