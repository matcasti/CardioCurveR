% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_RRi_curve.R
\name{estimate_RRi_curve}
\alias{estimate_RRi_curve}
\title{Estimate RRi Curve Using a Dual-Logistic Model for RR Interval Dynamics (Castillo-Aguilar et al.)}
\usage{
estimate_RRi_curve(
  time,
  RRi,
  start_params = c(alpha = 800, beta = -380, c = 0.85, lambda = -3, phi = -2, tau = 6,
    delta = 3),
  method = "L-BFGS-B"
)
}
\arguments{
\item{time}{A numeric vector of time points.}

\item{RRi}{A numeric vector of RR interval values.}

\item{start_params}{A named numeric vector of initial parameter estimates. Default is
\code{c(alpha = 800, beta = -380, c = 0.85, lambda = -3, phi = -2, tau = 6, delta = 3)}.}

\item{method}{A character string specifying the optimization method to use with \code{optim()}.
The default is \code{"L-BFGS-B"}, which allows for parameter constraints.}
}
\value{
A list containing:
\describe{
\item{data}{The input data (after removing missing cases) and fitted values
from the dual logistic model.}
\item{method}{The optimization method used.}
\item{parameters}{The estimated parameters from the model.}
\item{objective_value}{The final value of the objective (Huber loss) function.}
\item{convergence}{An integer code indicating convergence (0 indicates success).}
}
}
\description{
This function estimates parameters for a dual-logistic model applied to RR interval (RRi)
signals. The model is designed to capture both the rapid drop and subsequent recovery of RRi values
during exercise and recovery periods, as described in Castillo-Aguilar et al. (2025). A robust Huber loss
function (with a default \eqn{\delta} of 50 ms) is used to downweight the influence of outliers, ensuring
that the optimization process is robust even in the presence of noisy or ectopic beats.
}
\details{
The dual-logistic model, as described in Castillo-Aguilar et al. (2025), is defined as:

\deqn{
\text{RRi}(t) = \alpha + \frac{\beta}{1 + e^{\lambda (t - \tau)}} - \frac{c \, \beta}{1 + e^{\phi (t - \tau - \delta)}}
}

where:

\describe{
\item{\eqn{\alpha}}{is the baseline RRi level.}
\item{\eqn{\beta}}{controls the amplitude of the drop.}
\item{\eqn{\lambda}}{modulates the steepness of the drop phase.}
\item{\eqn{\tau}}{represents the time at which the drop is centered.}
\item{\eqn{c}}{scales the amplitude of the recovery relative to \eqn{\beta}.}
\item{\eqn{\phi}}{controls the steepness of the recovery phase.}
\item{\eqn{\delta}}{shifts the recovery phase in time relative to \eqn{\tau}.}
}

The function first cleans the input data by removing missing cases, then defines the dual-logistic model,
and an objective function based on the Huber loss (with a default \eqn{\delta} = 50 ms). The parameter
optimization is performed using \code{optim()} with box constraints (via \code{L-BFGS-B}) to ensure that
the parameters remain within physiologically plausible limits. The default lower and upper bounds are set
based on typical RRi signal ranges.
}
\examples{

true_params <- c(alpha = 800, beta = -300, c = 0.80,
                 lambda = -3, phi = -1, tau = 6, delta = 3)

time_vec <- seq(0, 20, by = 0.01)

set.seed(1234)

# Simulate an example RRi signal:
RRi_simulated <- dual_logistic(time_vec, true_params) +
                  rnorm(length(time_vec), sd = 30)

# Estimate the model parameters:
fit <- estimate_RRi_curve(time = time_vec, RRi = RRi_simulated)

# Print method
print(fit)

# Summary method
summary(fit)

# Plot method
plot(fit)

}
\references{
Castillo-Aguilar, et al. (2025). \emph{Enhancing Cardiovascular Monitoring: A Non-linear Model for Characterizing RR Interval Fluctuations in Exercise and Recovery}. \strong{Scientific Reports}, 15(1), 8628.
}
