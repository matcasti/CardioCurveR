<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate RRi Curve Using a Dual-Logistic Model for RR Interval Dynamics (Castillo-Aguilar et al.) — estimate_RRi_curve • CardioCurveR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate RRi Curve Using a Dual-Logistic Model for RR Interval Dynamics (Castillo-Aguilar et al.) — estimate_RRi_curve"><meta name="description" content="This function estimates parameters for a dual-logistic model applied to RR interval (RRi)
signals. The model is designed to capture both the rapid drop and subsequent recovery of RRi values
during exercise and recovery periods, as described in Castillo-Aguilar et al. (2025). A robust Huber loss
function (with a default \(\delta\) of 50 ms) is used to downweight the influence of outliers, ensuring
that the optimization process is robust even in the presence of noisy or ectopic beats."><meta property="og:description" content="This function estimates parameters for a dual-logistic model applied to RR interval (RRi)
signals. The model is designed to capture both the rapid drop and subsequent recovery of RRi values
during exercise and recovery periods, as described in Castillo-Aguilar et al. (2025). A robust Huber loss
function (with a default \(\delta\) of 50 ms) is used to downweight the influence of outliers, ensuring
that the optimization process is robust even in the presence of noisy or ectopic beats."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CardioCurveR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matcasti/CardioCurveR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate RRi Curve Using a Dual-Logistic Model for RR Interval Dynamics (Castillo-Aguilar et al.)</h1>
      <small class="dont-index">Source: <a href="https://github.com/matcasti/CardioCurveR/blob/main/R/estimate_RRi_curve.R" class="external-link"><code>R/estimate_RRi_curve.R</code></a></small>
      <div class="d-none name"><code>estimate_RRi_curve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates parameters for a dual-logistic model applied to RR interval (RRi)
signals. The model is designed to capture both the rapid drop and subsequent recovery of RRi values
during exercise and recovery periods, as described in Castillo-Aguilar et al. (2025). A robust Huber loss
function (with a default \(\delta\) of 50 ms) is used to downweight the influence of outliers, ensuring
that the optimization process is robust even in the presence of noisy or ectopic beats.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_RRi_curve</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">RRi</span>,</span>
<span>  start_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">800</span>, beta <span class="op">=</span> <span class="op">-</span><span class="fl">380</span>, c <span class="op">=</span> <span class="fl">0.85</span>, lambda <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, phi <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, tau <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"L-BFGS-B"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A numeric vector of time points.</p></dd>


<dt id="arg-rri">RRi<a class="anchor" aria-label="anchor" href="#arg-rri"></a></dt>
<dd><p>A numeric vector of RR interval values.</p></dd>


<dt id="arg-start-params">start_params<a class="anchor" aria-label="anchor" href="#arg-start-params"></a></dt>
<dd><p>A named numeric vector of initial parameter estimates. Default is
<code>c(alpha = 800, beta = -380, c = 0.85, lambda = -3, phi = -2, tau = 6, delta = 3)</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character string specifying the optimization method to use with <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>.
The default is <code>"L-BFGS-B"</code>, which allows for parameter constraints.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><dl><dt>data</dt>
<dd><p>The input data (after removing missing cases) and fitted values
from the dual logistic model.</p></dd>

<dt>method</dt>
<dd><p>The optimization method used.</p></dd>

<dt>parameters</dt>
<dd><p>The estimated parameters from the model.</p></dd>

<dt>objective_value</dt>
<dd><p>The final value of the objective (Huber loss) function.</p></dd>

<dt>convergence</dt>
<dd><p>An integer code indicating convergence (0 indicates success).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The dual-logistic model, as described in Castillo-Aguilar et al. (2025), is defined as:</p>
<p>$$
\text{RRi}(t) = \alpha + \frac{\beta}{1 + e^{\lambda (t - \tau)}} - \frac{c \, \beta}{1 + e^{\phi (t - \tau - \delta)}}
$$</p>
<p>where:</p>
<dl><dt>\(\alpha\)</dt>
<dd><p>is the baseline RRi level.</p></dd>

<dt>\(\beta\)</dt>
<dd><p>controls the amplitude of the drop.</p></dd>

<dt>\(\lambda\)</dt>
<dd><p>modulates the steepness of the drop phase.</p></dd>

<dt>\(\tau\)</dt>
<dd><p>represents the time at which the drop is centered.</p></dd>

<dt>\(c\)</dt>
<dd><p>scales the amplitude of the recovery relative to \(\beta\).</p></dd>

<dt>\(\phi\)</dt>
<dd><p>controls the steepness of the recovery phase.</p></dd>

<dt>\(\delta\)</dt>
<dd><p>shifts the recovery phase in time relative to \(\tau\).</p></dd>


</dl><p>The function first cleans the input data by removing missing cases, then defines the dual-logistic model,
and an objective function based on the Huber loss (with a default \(\delta\) = 50 ms). The parameter
optimization is performed using <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> with box constraints (via <code>L-BFGS-B</code>) to ensure that
the parameters remain within physiologically plausible limits. The default lower and upper bounds are set
based on typical RRi signal ranges.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Castillo-Aguilar, et al. (2025). <em>Enhancing Cardiovascular Monitoring: A Non-linear Model for Characterizing RR Interval Fluctuations in Exercise and Recovery</em>. <strong>Scientific Reports</strong>, 15(1), 8628.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Simulate an example RRi signal:</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">time_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">true_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1000</span>, beta <span class="op">=</span> <span class="op">-</span><span class="fl">380</span>, c <span class="op">=</span> <span class="fl">0.85</span>,</span></span>
<span class="r-in"><span>                   lambda <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, phi <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, tau <span class="op">=</span> <span class="fl">6</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">RRi_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="dual_logistic.html">dual_logistic</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="va">true_params</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time_vec</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Estimate the model parameters:</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_RRi_curve</span><span class="op">(</span>time <span class="op">=</span> <span class="va">time_vec</span>, RRi <span class="op">=</span> <span class="va">RRi_simulated</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="va">RRi_simulated</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Time (min)"</span>, ylab <span class="op">=</span> <span class="st">"RRi (ms)"</span>,</span></span>
<span class="r-in"><span>       main <span class="op">=</span> <span class="st">"Signal and fitted RRi Non-Linear Model"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="fu"><a href="dual_logistic.html">dual_logistic</a></span><span class="op">(</span><span class="va">time_vec</span>, <span class="va">fit</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matías Castillo-Aguilar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

