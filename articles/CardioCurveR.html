<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get Started • CardioCurveR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started">
<link href="./logo.png" rel="icon" type="image/png">
<link href="./logo.png" rel="icon" type="image/png" sizes="16x16">
<link href="./logo.png" rel="icon" type="image/png" sizes="32x32">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CardioCurveR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/CardioCurveR.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-fw fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>External Articles</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.nature.com/articles/s41598-025-93654-6">Original Scientific Paper</a></li>
    <li><a class="external-link dropdown-item" href="https://doi.org/10.59350/qfn6w-qyt38">Explainer Blog Post</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fab fa-r-project"></span> Documentation</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-history"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matcasti/CardioCurveR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/matcasti/CardioCurveR/blob/main/vignettes/articles/CardioCurveR.Rmd" class="external-link"><code>vignettes/articles/CardioCurveR.Rmd</code></a></small>
      <div class="d-none name"><code>CardioCurveR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-your-in-depth-introduction-to-cardiocurver">Welcome to Your In-Depth Introduction to CardioCurveR!<a class="anchor" aria-label="anchor" href="#welcome-to-your-in-depth-introduction-to-cardiocurver"></a>
</h2>
<p>Welcome! This guide serves as your comprehensive first step into the
world of <strong>CardioCurveR</strong>, an R package specifically
designed for analyzing the dynamic changes in heart rate intervals
(known as R-R intervals) during exercise and recovery periods.
Understanding these dynamics is crucial in various fields, from sports
science and physiology to clinical research, as it provides deep
insights into cardiovascular control, fitness levels, and autonomic
nervous system function. This tutorial is structured as a practical,
hands-on example, meaning we won’t just talk <em>about</em> the
concepts; we’ll actively apply them using R code. To get the absolute
most out of this learning experience, we strongly encourage you to
execute the code snippets provided as we progress through the
material.</p>
<p>Before we can dive into the exciting analysis, the very first,
essential prerequisite is ensuring that the
<strong>CardioCurveR</strong> package, along with all the other software
packages it relies on, are correctly installed within your R
environment. R packages are collections of functions, data, and compiled
code in a well-defined format, created to add specific functionality. If
you haven’t installed <strong>CardioCurveR</strong> yet, you can do so
by executing the following command directly within your R console. This
single command handles not just the main package but also fetches and
installs any other packages that <strong>CardioCurveR</strong> needs to
operate correctly, thanks to the <code>dependencies = TRUE</code>
argument. This argument is incredibly useful as it saves you the trouble
of identifying and installing each required package manually,
streamlining the setup process considerably.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the main CardioCurveR package</span></span>
<span><span class="co"># The 'dependencies = TRUE' argument is crucial here. It tells R to</span></span>
<span><span class="co"># automatically identify, download, and install all other packages</span></span>
<span><span class="co"># that CardioCurveR needs to function properly. This often includes</span></span>
<span><span class="co"># packages for data manipulation, plotting, statistical modeling, etc.</span></span>
<span><span class="co"># This ensures a complete and functional setup with a single command.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"CardioCurveR"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Make sure you have an active internet connection when running this
command, as R needs to download the package files from the Comprehensive
R Archive Network (CRAN) or another specified repository. Depending on
the number of dependencies, this process might take a few minutes.</p>
</div>
<div class="section level2">
<h2 id="prepare-your-r-workspace-loading-necessary-packages">Prepare Your R Workspace: Loading Necessary Packages<a class="anchor" aria-label="anchor" href="#prepare-your-r-workspace-loading-necessary-packages"></a>
</h2>
<p>Having successfully installed <strong>CardioCurveR</strong> and its
dependencies in the previous step, we now need to make their
functionalities available within our current R session. Installation is
a one-time process (per R installation or major update), but loading the
package is required <em>every time</em> you start a new R session and
intend to use functions from that package. Think of installation as
putting a book on your bookshelf, while loading is like taking that
specific book off the shelf to read it.</p>
<p>The standard procedure for using any R package follows these two
distinct steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Installation:</strong> Ensure the package is physically
present on your system’s library. This is achieved using the
<code>install.packages("package_name")</code> command, which you’ve
already completed for <strong>CardioCurveR</strong>.</li>
<li>
<strong>Loading:</strong> Bring the package’s functions, datasets,
and other objects into your current R session’s memory so you can
directly call them. This is done using the
<code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(package_name)</a></code> command. This step essentially
attaches the package to your search path, allowing R to find the
functions associated with it.</li>
</ol>
<p>Therefore, to prepare our workspace for the analysis and
visualization tasks ahead, we need to explicitly load
<strong>CardioCurveR</strong> and another helpful package,
<strong>ggplot2</strong>. <strong>ggplot2</strong> is a widely acclaimed
package for creating sophisticated and aesthetically pleasing data
visualizations, and while not strictly necessary for the core modeling
function of <strong>CardioCurveR</strong>, it greatly enhances our
ability to explore and present the results effectively.</p>
<p>Execute the following code block in your R console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the core package for this tutorial. Once loaded, functions like</span></span>
<span><span class="co"># import_RRi_txt() and estimate_RRi_curve() become directly available.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/matcasti/CardioCurveR" class="external-link">CardioCurveR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the ggplot2 package. This package provides powerful and flexible</span></span>
<span><span class="co"># tools for creating a wide variety of plots beyond R's base graphics.</span></span>
<span><span class="co"># We'll use it later for potentially more advanced or customized visualizations,</span></span>
<span><span class="co"># although the base plot functions will also be demonstrated.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>By running these <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> commands, you are telling R:
“Make the functions and capabilities contained within the
<strong>CardioCurveR</strong> and <strong>ggplot2</strong> packages
ready for me to use right now.”.</p>
<p>If you encounter an error message like <em>“there is no package
called…”</em>, double-check that the installation step was completed
without errors.</p>
</div>
<div class="section level2">
<h2 id="defining-our-subject-importing-the-heart-rate-interval-data">Defining Our Subject: Importing the Heart Rate Interval Data<a class="anchor" aria-label="anchor" href="#defining-our-subject-importing-the-heart-rate-interval-data"></a>
</h2>
<p>With our R environment properly set up and the necessary packages
loaded, we arrive at the core of any data analysis task: acquiring the
data itself. In the context of <strong>CardioCurveR</strong>, we are
primarily interested in sequences of R-R intervals. An R-R interval
(RRi) represents the time duration, typically measured in milliseconds
(ms), between two consecutive R waves on an electrocardiogram (ECG). The
R wave is usually the most prominent peak in the ECG signal,
corresponding to the main contraction (depolarization) of the heart’s
ventricles. Therefore, a sequence of R-R intervals provides a precise,
beat-to-beat measure of heart rate variability over time.</p>
<p>The data format <strong>CardioCurveR</strong> is primarily designed
to work with is intentionally simple and widely compatible. It expects a
plain text file (often with a <code>.txt</code> extension) where each
line contains a single numerical value representing one R-R interval
duration in milliseconds.</p>
<div class="float">
<img src="how-data-looks.png" alt="Diagram showing a text file with one R-R interval value (e.g., 850, 845, 860) per line."><div class="figcaption">Diagram showing a text file with one R-R
interval value (e.g., 850, 845, 860) per line.</div>
</div>
<p>This straightforward, one-value-per-line format is a common output
option when exporting raw beat-to-beat data from various heart rate
monitoring devices, including clinical-grade ECG recorders,
research-focused ambulatory monitors, consumer chest straps (like Polar
or Garmin), and even some advanced smartwatches. The simplicity ensures
broad usability.</p>
<p>(<strong>Aside</strong>: To allow you to actively participate and
replicate the analysis steps shown here, you can download the example
dataset we’ll be using throughout this tutorial:
<a href="example_data.txt" download="example_data.txt"><code>example_data.txt</code></a>.
Please download this file and save it to a location on your computer
where you can easily find it, such as your working directory for this R
project.)</p>
<p>Importing this type of data file into R using
<strong>CardioCurveR</strong> is facilitated by the dedicated
<code><a href="../reference/import_RRi_txt.html">import_RRi_txt()</a></code> function. The most crucial piece of
information this function needs is the <em>path</em> to the data file on
your computer. A file path is like a specific address that tells R
exactly where to locate the file. It needs to be provided as a character
string (enclosed in quotes). Here’s the two-step process:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Step 1: Define the file path</span></span>
<span><span class="co"># We create a variable 'my_file' to store the name (and potentially path)</span></span>
<span><span class="co"># of our data file. If "example_data.txt" is in your current R working directory,</span></span>
<span><span class="co"># just the filename is sufficient. Otherwise, you'd provide the full path,</span></span>
<span><span class="co"># e.g., "C:/Users/YourName/Documents/example_data.txt" or "/home/yourname/data/example_data.txt".</span></span>
<span><span class="co"># Remember to use forward slashes '/' even on Windows.</span></span>
<span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"example_data.txt"</span></span>
<span></span>
<span><span class="co">## Step 2: Import the data using the specified path</span></span>
<span><span class="co"># The import_RRi_txt function reads the file line by line, expecting each line</span></span>
<span><span class="co"># to contain a single R-R interval value. It performs initial validation and</span></span>
<span><span class="co"># returns the data in a structured format (a data frame) suitable for further analysis.</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_RRi_txt.html">import_RRi_txt</a></span><span class="op">(</span><span class="va">my_file</span><span class="op">)</span></span></code></pre></div>
<p><strong>Alternative File Selection:</strong> If specifying file paths
feels cumbersome or you’re unsure about the exact location or syntax, R
provides an interactive alternative. You can replace the code in Step 1
above with <code>my_file &lt;- file.choose()</code>. Executing this will
open your operating system’s standard file selection dialog box,
allowing you to navigate your folders and click on the desired
<code>example_data.txt</code> file directly. This method is often more
intuitive, especially for users less familiar with command-line
interfaces or file system structures.</p>
<p>Once the data is successfully imported and stored in the
<code>my_data</code> variable (which is now an R object called a data
frame, containing columns for time and RRi), a good first step is always
to visualize it. This gives us an immediate qualitative feel for the
data’s pattern. We can achieve a quick basic plot using R’s built-in
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Step 3: Generate a preliminary plot of the imported R-R intervals</span></span>
<span><span class="co"># We pass the imported data frame 'my_data' to the plot function.</span></span>
<span><span class="co"># The 'type = "l"' argument specifically requests a line plot,</span></span>
<span><span class="co"># connecting the consecutive R-R interval points over time, which is</span></span>
<span><span class="co"># ideal for visualizing trends in time-series data like this.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_data</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CardioCurveR_files/figure-html/unnamed-chunk-3-1.svg" width="100%"></p>
<p>The plot you see represents the R-R intervals over the duration of
the recording. However, it’s important to understand that the data
displayed here might already have undergone some pre-processing. By
default, the <code><a href="../reference/import_RRi_txt.html">import_RRi_txt()</a></code> function performs crucial
cleaning steps to enhance data quality. Firstly, it attempts to identify
and remove <em>ectopic beats</em>, i.e., heartbeats originating from
locations other than the sinoatrial node (the heart’s natural
pacemaker), which can manifest as unusually short or long RR intervals
that disrupt the underlying physiological rhythm. Removing these
artifacts is vital for accurate modeling of the intended cardiovascular
response. Secondly, the function offers an option (enabled by default,
but controllable via arguments) to apply a <em>Butterworth low-pass
filter</em>. This type of digital filter helps to smooth out
high-frequency noise in the data, which might arise from measurement
inaccuracies or minor physiological fluctuations, without distorting the
main trend of the exercise response and recovery. The filtering uses a
zero-phase approach (<code>filtfilt</code>) to avoid introducing time
delays into the signal. For a comprehensive understanding of all the
import options, including controlling the filtering process, specifying
time units, or handling different file encodings, you should consult the
function’s detailed documentation by typing <code><a href="../reference/import_RRi_txt.html">?import_RRi_txt</a></code>
into your R console. This help page provides a full description of all
arguments and their functionalities.</p>
</div>
<div class="section level2">
<h2 id="applying-the-model-fitting-a-curve-to-the-dynamics">Applying the Model: Fitting a Curve to the Dynamics<a class="anchor" aria-label="anchor" href="#applying-the-model-fitting-a-curve-to-the-dynamics"></a>
</h2>
<p>We now arrive at the central and most revealing part of our analysis:
mathematically modeling the observed pattern of R-R intervals during the
exercise and recovery sequence. The goal is to fit a specific
mathematical curve that captures the characteristic physiological
changes, i.e., the initial drop in RRi (increase in heart rate) at the
onset of exercise, the stabilization during exertion (if present), and
the subsequent rise in RRi (decrease in heart rate) during the recovery
phase.</p>
<p>Fortunately, <strong>CardioCurveR</strong> encapsulates the
complexity of this modeling process within a single, user-friendly
function: <code><a href="../reference/estimate_RRi_curve.html">estimate_RRi_curve()</a></code>. While the underlying
mathematics and optimization algorithms are sophisticated (indeed, the
development of this package involved significant effort to make this
step straightforward for the user), applying the model is remarkably
simple. We just need to provide the time data and the corresponding R-R
interval data to the function. A convenient way to do this when the data
is in a data frame like <code>my_data</code> (which has columns named
<code>time</code> and <code>RRi</code> as prepared by
<code>import_RRi_txt</code>) is to use the <code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> function.
<code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code> allows us to evaluate an R expression within the
context of a specific data environment (our data frame), so we can refer
to the columns <code>time</code> and <code>RRi</code> directly by name
without needing to repeatedly type <code>my_data$time</code> and
<code>my_data$RRi</code>.</p>
<p>Here’s how we fit the model:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Step 4: Fit the specialized R-R interval curve model</span></span>
<span><span class="co"># We use with(my_data, ...) to temporarily make the columns of 'my_data'</span></span>
<span><span class="co"># directly accessible. Inside, we call estimate_RRi_curve(), passing the</span></span>
<span><span class="co"># 'time' column as the independent variable (x-axis) and the 'RRi' column</span></span>
<span><span class="co"># as the dependent variable (y-axis) that we want to model.</span></span>
<span><span class="co"># The function applies the specific mathematical model developed for</span></span>
<span><span class="co"># exercise RRi dynamics and uses optimization techniques to find the</span></span>
<span><span class="co"># parameter values that make the curve best fit the observed data points.</span></span>
<span><span class="co"># The result, containing the fitted model and its parameters, is stored</span></span>
<span><span class="co"># in the 'my_model' object.</span></span>
<span><span class="va">my_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="fu"><a href="../reference/estimate_RRi_curve.html">estimate_RRi_curve</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">RRi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Executing this line performs the core computation. The
<code><a href="../reference/estimate_RRi_curve.html">estimate_RRi_curve()</a></code> function fits a predefined non-linear
model (based on the work cited later) to your time and RRi data points,
estimating the parameters of that model using numerical optimization
methods. The result is stored in a new R object, which we’ve named
<code>my_model</code>. This object now contains all the information
about the fitted curve, including the estimated parameter values,
goodness-of-fit statistics, and more.</p>
<p>Okay, the calculation is done… but what does it mean? Did the model
actually fit the data well, or is it a poor representation?</p>
<p>Before interpreting the parameters, it’s crucial to assess the
quality of the model fit. A standard way to get a statistical overview
of a fitted model in R is by using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.
Applying <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to our <code>my_model</code> object will
print out key information, such as the estimated values of the model
parameters, their standard errors (a measure of uncertainty), and
overall goodness-of-fit metrics like the residual standard error or
R-squared.</p>
<p>Let’s examine the summary:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Step 5: Obtain a statistical summary of the fitted model</span></span>
<span><span class="co"># The summary() function is a generic function in R that provides a</span></span>
<span><span class="co"># condensed overview of an object. When applied to model objects like</span></span>
<span><span class="co"># the one returned by estimate_RRi_curve(), it typically displays</span></span>
<span><span class="co"># parameter estimates, uncertainty measures, and fit statistics.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of RRi_fit Object</span></span>
<span><span class="co">#&gt; Optimization Method: L-BFGS-B </span></span>
<span><span class="co">#&gt; Estimated Parameters:</span></span>
<span><span class="co">#&gt;        alpha         beta            c       lambda          phi          tau </span></span>
<span><span class="co">#&gt;  801.9017917 -468.1684814    0.7966331   -2.6606101   -1.5997960    7.7939789 </span></span>
<span><span class="co">#&gt;        delta </span></span>
<span><span class="co">#&gt;    2.0515660 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Objective Value (Huber loss): 1777818 </span></span>
<span><span class="co">#&gt; Residual Sum of Squares (RSS): 3924430 </span></span>
<span><span class="co">#&gt; Total Sum of Squares (TSS): 26051637 </span></span>
<span><span class="co">#&gt; R-squared: 0.8494 </span></span>
<span><span class="co">#&gt; Root Mean Squared Error (RMSE): 44.8  ms </span></span>
<span><span class="co">#&gt; Mean Absolute Percentage Error (MAPE): 5.5  % </span></span>
<span><span class="co">#&gt; Number of observations: 1956 </span></span>
<span><span class="co">#&gt; Convergence Code: 0</span></span>
<span></span>
<span><span class="co"># Alternatively, simply printing the model object often gives a concise</span></span>
<span><span class="co"># view focused primarily on the parameter estimates, which we'll also use later.</span></span>
<span><span class="co"># print(my_model)</span></span></code></pre></div>
<p>In addition to the numerical summary, visual diagnostics are
indispensable for judging model fit, especially with time-series or
non-linear data. <strong>CardioCurveR</strong> provides a specialized
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for objects created by
<code><a href="../reference/estimate_RRi_curve.html">estimate_RRi_curve()</a></code>. Calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on our
<code>my_model</code> object generates a set of diagnostic plots
specifically designed for this type of analysis. These plots typically
include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Fitted Curve vs. Data:</strong> The original R-R interval
data points plotted alongside the smooth curve predicted by the fitted
model. This allows for a direct visual assessment of how well the curve
captures the overall trend and shape of the data.</li>
<li>
<strong>Residuals vs. Time:</strong> A plot of the residuals (the
differences between the observed RRi values and the values predicted by
the model) against time. Ideally, residuals should appear randomly
scattered around zero, without any obvious patterns or trends. Patterns
in residuals might indicate model inadequacy (e.g., the chosen curve
shape doesn’t fully capture the dynamics) or issues like non-constant
variance.</li>
<li>
<strong>Histogram of Residuals:</strong> A plot with the overall
distribution of model residuals (i.e., how far each data points is from
the predicted value). This type of plots helps us understand if the
model is capturing the data properly. What we should strive to look is a
histogram with (approximately) normally distributed residuals centered
over zero.</li>
</ol>
<p>Let’s generate these diagnostic visualizations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calling plot() on the 'my_model' object invokes a specialized plotting</span></span>
<span><span class="co"># method designed for CardioCurveR model results. It generates multiple</span></span>
<span><span class="co"># informative plots arranged together, helping us visually assess the</span></span>
<span><span class="co"># model's performance and assumptions. The chunk options fig.height and</span></span>
<span><span class="co"># out.width are used here to adjust the display size in the output document.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span></span></code></pre></div>
<p><img src="CardioCurveR_files/figure-html/unnamed-chunk-6-1.svg" width="100%"></p>
<p>Carefully examining these plots is crucial. Does the fitted line
follow the data points reasonably well? Do the residuals look like
random noise around zero, or is there a systematic pattern left
unexplained by the model? Answering these questions helps build
confidence (or reveals concerns) about the validity of the model before
proceeding to interpret its parameters.</p>
</div>
<div class="section level2">
<h2 id="making-sense-of-the-fit-interpreting-the-model-parameters">Making Sense of the Fit: Interpreting the Model Parameters<a class="anchor" aria-label="anchor" href="#making-sense-of-the-fit-interpreting-the-model-parameters"></a>
</h2>
<p>Now that we have successfully fitted the mathematical model to our
R-R interval data and performed initial checks on the quality of the fit
using both numerical summaries and diagnostic plots, we can move on to
the most insightful step: understanding what the model’s parameters tell
us about the underlying physiological response during the exercise
bout.</p>
<p>Let’s first recall the estimated parameter values by printing the
model object again, focusing specifically on the section detailing these
estimates:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing the model object provides a concise output, often highlighting</span></span>
<span><span class="co"># the core results, particularly the estimated parameter values.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; RRi_fit Object</span></span>
<span><span class="co">#&gt; Optimization Method: L-BFGS-B </span></span>
<span><span class="co">#&gt; Estimated Parameters:</span></span>
<span><span class="co">#&gt;        alpha         beta            c       lambda          phi          tau </span></span>
<span><span class="co">#&gt;  801.9017917 -468.1684814    0.7966331   -2.6606101   -1.5997960    7.7939789 </span></span>
<span><span class="co">#&gt;        delta </span></span>
<span><span class="co">#&gt;    2.0515660 </span></span>
<span><span class="co">#&gt; Objective Value (Huber loss): 1777818 </span></span>
<span><span class="co">#&gt; Convergence Code: 0</span></span></code></pre></div>
<p>Look closely at the output section labeled “Estimated Parameters” (or
similar). You’ll see several parameters, often denoted by Greek letters
(alpha, beta, lambda, tau, etc.). These are not just abstract
mathematical constants; each one is designed to quantify a specific
aspect of the heart rate dynamic curve observed during exercise and
recovery. They provide a concise, quantitative description of the
individual’s cardiovascular response profile.</p>
<p>To understand their meaning, let’s refer to an illustrative figure
showing a typical R-R interval curve during an exercise protocol (like
rest-exercise-recovery) and how the parameters relate to its different
phases and features:</p>
<p><img src="illustrative_curve.svg" style="width:100.0%"></p>
<p>Let’s break down the physiological interpretation of each key
parameter, relating it to the curve’s shape:</p>
<ul>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
(alpha): Baseline RRi.</strong> This parameter represents the initial,
resting R-R interval duration <em>before</em> the onset of exercise
stimulus. It essentially anchors the start of the curve and reflects the
individual’s baseline heart rate (longer RRi means lower heart
rate).</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
(beta): Amplitude of RRi Drop.</strong> This parameter quantifies the
magnitude of the decrease in R-R interval duration from the baseline
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
to the approximate lowest point reached during the exercise phase. A
larger (more negative, or larger absolute value)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
indicates a greater overall reduction in RRi (i.e., a larger increase in
heart rate) in response to the exercise challenge.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
(lambda): Steepness of RRi Drop.</strong> Lambda controls how rapidly
the R-R interval decreases during the initial phase of exercise (the
“on-transient”). A larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
value corresponds to a steeper, faster drop in RRi (a quicker heart rate
acceleration) as the exercise begins.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
(tau): Time Center of the Drop.</strong> This parameter represents the
approximate time point around which the main decrease in R-R interval
occurs. It essentially locates the midpoint of the primary transition
from rest to the exercise heart rate level along the time axis.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
(c): Recovery Amplitude Scaling.</strong> The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
relates the amplitude of the R-R interval recovery <em>after</em>
exercise cessation to the amplitude of the initial drop
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>).
It scales how much the RRi increases during recovery relative to how
much it decreased during exercise onset. Values around 1 might suggest a
recovery that roughly mirrors the initial drop in magnitude, while other
values indicate different recovery extents.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
(phi): Steepness of Recovery Phase.</strong> Similar to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for the drop,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
controls the steepness or rate of the R-R interval increase during the
post-exercise recovery period (the “off-transient”). A larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
value indicates a faster recovery, meaning the heart rate decelerates
more quickly back towards baseline levels after exercise stops.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
(delta): Time Shift of Recovery Phase.</strong> Delta adjusts the
temporal position of the recovery phase relative to the drop phase
centered at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.
It allows the model to account for situations where the recovery might
start slightly before or after what would be expected based solely on
the timing of the drop, adding flexibility to capture the precise timing
of the off-kinetics.</li>
</ul>
<p>So, by examining these estimated parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>λ</mi><mo>,</mo><mi>τ</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>ϕ</mi><mo>,</mo><mi>δ</mi></mrow><annotation encoding="application/x-tex">\alpha, \beta, \lambda, \tau, c, \phi, \delta</annotation></semantics></math>),
we gain a multi-faceted quantitative summary of the individual’s heart
rate dynamics throughout the entire rest-exercise-recovery protocol.
These parameters can be compared across individuals, conditions, or
interventions to study differences in cardiovascular control, fitness,
or the effects of training.</p>
<p>There you have it! This detailed walkthrough covers the essential
workflow for using <strong>CardioCurveR</strong> to import R-R interval
data, fit the specialized physiological model developed and described in
the scientific literature (specifically referencing <a href="https://www.nature.com/articles/s41598-025-93654-6" class="external-link">Castillo-Aguilar
et al. (2025)</a> – <em>note: please verify this citation as it might be
hypothetical or require updating</em>), and interpret the resulting
parameters. Now you are well-equipped to apply this methodology to your
own datasets or to further explore using the provided
<a href="example_data.txt" download="example_data.txt">example data
file</a>.</p>
<p>The analysis doesn’t necessarily have to stop here. The fitted model
object (<code>my_model</code>) can serve as a basis for more advanced
statistical techniques. For instance, one could perform
<strong>bootstrap resampling</strong> to obtain more robust estimates of
the uncertainty surrounding each parameter (confidence intervals).
Alternatively, adopting a <strong>Bayesian statistical
framework</strong> could provide richer insights through posterior
distributions for the parameters, allowing for probabilistic statements
about their values. However, these advanced topics extend beyond this
introductory tutorial and are avenues for future exploration.</p>
<p>We hope this comprehensive guide proves valuable in your work. Best
of luck with your R-R interval analyses using
<strong>CardioCurveR</strong>!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.bayesically-speaking.com/cv" class="external-link">Matías Castillo-Aguilar</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>CardioCurveR</p>
</div>

    </footer>
</div>





  </body>
</html>
